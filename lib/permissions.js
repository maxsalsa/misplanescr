import { prisma } from "@/lib/db"; export async function checkSubjectLicense(uid, s) { if(!uid||!s) return false; const u=await prisma.user.findUnique({where:{id:uid}}); if(u?.role==="ADMIN"||u?.subscriptionStatus==="VIP") return true; const l=await prisma.license.findMany({where:{userId:uid,isActive:true}}); const sn=s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""); return l.some(x=>{const ln=x.subject.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""); return ln==="todas"||ln===sn||sn.includes(ln)}); }