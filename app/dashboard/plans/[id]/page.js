"use client"; import { useEffect, useState } from "react"; import { useRouter } from "next/navigation"; import { useSession } from "next-auth/react"; import { ArrowLeft, Printer, HeartHandshake, Gamepad2, Youtube, GraduationCap, Layout } from "lucide-react"; import DownloadPDF from "@/components/reports/DownloadPDF"; export default function PlanView({ params }) { const { data: session } = useSession(); const [plan, setPlan] = useState(null); const [tab, setTab] = useState("OFFICIAL"); const router = useRouter(); useEffect(() => { Promise.resolve(params).then(p => fetch(`/api/plans/search?id=${p.id}`).then(r=>r.json()).then(d=>setPlan(d[0]))) }, [params]); if (!plan) return <div className="p-20 text-center">Cargando...</div>; const content = typeof plan.content === "string" ? JSON.parse(plan.content) : plan.content; const res = content.resources_360 || {}; const inc = content.inclusivity || {}; const game = content.gamification || {}; const mat = content.student_materials || {}; return ( <div className="bg-slate-50 min-h-screen pb-20"> <div className="bg-white border-b sticky top-0 z-20 px-6 py-4 shadow-sm flex justify-between"> <div className="flex gap-4"><button onClick={()=>router.back()} className="btn btn-ghost btn-circle"><ArrowLeft/></button><div><h1 className="font-bold">{plan.title}</h1></div></div> <div className="join bg-slate-100 p-1"> <button onClick={()=>setTab("OFFICIAL")} className={`btn btn-sm join-item ${tab==="OFFICIAL"?"btn-white shadow":""}`}>Plan</button> <button onClick={()=>setTab("STUDENT")} className={`btn btn-sm join-item ${tab==="STUDENT"?"btn-white shadow":""}`}>Material Estudiante</button> <button onClick={()=>setTab("GAMIFICATION")} className={`btn btn-sm join-item ${tab==="GAMIFICATION"?"btn-white shadow":""}`}>Juegos</button> <button onClick={()=>setTab("INCLUSION")} className={`btn btn-sm join-item ${tab==="INCLUSION"?"btn-white shadow":""}`}>Apoyos</button> </div> <DownloadPDF plan={plan} user={session?.user}/> </div> <div className="max-w-[21cm] mx-auto mt-8 bg-white shadow-xl p-12 text-sm"> {tab==="OFFICIAL" && <div><h1 className="text-center font-bold mb-4">PLAN DE PRÁCTICA PEDAGÓGICA</h1><table className="w-full border"><thead><tr className="bg-gray-100"><th className="border p-2">Resultados</th><th className="border p-2">Estrategias</th><th className="border p-2">Indicadores</th></tr></thead><tbody><tr><td className="border p-2"><ul className="list-disc pl-4">{content.objectives?.map((o,i)=><li key={i}>{o}</li>)}</ul></td><td className="border p-2">{Object.values(content.strategies||{}).map((s,i)=><p key={i} className="mb-2">{s}</p>)}</td><td className="border p-2"><ul className="list-square pl-4">{content.planning_module?.rubric?.map((r,i)=><li key={i}>{r.indicator}</li>)}</ul></td></tr></tbody></table></div>} {tab==="STUDENT" && <div className="space-y-6"> <h3 className="text-xl font-bold text-blue-600 flex gap-2"><GraduationCap/> Resumen para el Estudiante</h3> <div className="bg-blue-50 p-4 rounded-xl text-lg font-serif leading-relaxed">{mat.summary}</div> <h3 className="text-xl font-bold text-orange-600 flex gap-2 mt-8"><Layout/> Puntos para Infografía</h3> <ul className="grid grid-cols-2 gap-4">{mat.infographic_points?.map((pt,i)=><li key={i} className="bg-orange-50 p-4 rounded-lg font-bold text-center border border-orange-200">{pt}</li>)}</ul> </div>} {tab==="GAMIFICATION" && <div className="space-y-6"><h3 className="text-xl font-bold flex items-center gap-2 text-pink-600"><Gamepad2/> Arcade y Recursos</h3><div className="grid gap-4">{game.resources?.map((r,i)=>(<div key={i} className="bg-slate-50 p-4 rounded-xl flex items-center gap-4 border"><div className="bg-white p-3 rounded-full shadow">{r.type==="VIDEO"?<Youtube className="text-red-500"/>:<Gamepad2 className="text-purple-500"/>}</div><div><h4 className="font-bold">{r.name}</h4><p className="text-xs text-slate-500">{r.desc}</p></div></div>))}</div>{game.arcade_trivia && <div className="bg-purple-600 text-white p-6 rounded-xl mt-4"><h4 className="font-black mb-2">TRIVIA TIME: {game.arcade_trivia[0]?.question}</h4><div className="grid grid-cols-2 gap-2">{game.arcade_trivia[0]?.options.map((o,i)=><button key={i} className="btn btn-outline text-white hover:bg-white hover:text-purple-600">{o}</button>)}</div></div>}</div>} {tab==="INCLUSION" && <div className="space-y-4"><h3 className="font-bold flex gap-2 text-purple-700"><HeartHandshake/> Diversidad</h3><div className="bg-purple-50 p-4 rounded"><b>Adecuaciones:</b> {inc.adecuaciones?.join(", ")}</div></div>} </div> </div> ); }