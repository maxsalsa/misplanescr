import { prisma } from "@/lib/db"; import { NextResponse } from "next/server"; export async function GET(req) { const {searchParams}=new URL(req.url); if(searchParams.get("studentId")) return NextResponse.json(await prisma.conductIncident.findMany({where:{studentId:searchParams.get("studentId")},orderBy:{date:"desc"}})); if(searchParams.get("groupId")) return NextResponse.json(await prisma.student.findMany({where:{groupId:searchParams.get("groupId")},include:{conductIncidents:true}})); return NextResponse.json([]); } export async function POST(req) { const {studentId,type,description,points}=await req.json(); return NextResponse.json(await prisma.conductIncident.create({data:{studentId,type,description,pointsDeducted:parseInt(points),date:new Date()}})); } export async function DELETE(req) { await prisma.conductIncident.delete({where:{id:new URL(req.url).searchParams.get("id")}}); return NextResponse.json({success:true}); }