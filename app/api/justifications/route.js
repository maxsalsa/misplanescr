import { prisma } from "@/lib/db"; import { NextResponse } from "next/server"; export async function GET(req){const {searchParams}=new URL(req.url); const u=searchParams.get("userId"); if(u)return NextResponse.json(await prisma.justification.findMany({where:{userId:u}})); return NextResponse.json(await prisma.justification.findMany({where:{type:"DOCENTE"},include:{user:true}}));} export async function POST(req){const d=await req.json();await prisma.justification.create({data:{type:d.type,reason:d.reason,description:d.description,dateFrom:new Date(d.dateFrom),dateTo:new Date(d.dateTo),userId:d.userId,evidenceUrl:d.evidenceUrl,status:"PENDIENTE"}});return NextResponse.json({success:true});} export async function PUT(req){const {id,status,feedback}=await req.json();await prisma.justification.update({where:{id},data:{status,adminFeedback:feedback}});return NextResponse.json({success:true});}