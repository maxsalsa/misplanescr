import { prisma } from "@/lib/db"; import { hash } from "bcryptjs"; import { NextResponse } from "next/server"; export async function POST(req) { try { const { userId, newPassword } = await req.json(); const hashedPassword = await hash(newPassword, 10); await prisma.user.update({ where: { id: userId }, data: { password: hashedPassword, mustChangePassword: false } }); return NextResponse.json({ success: true }); } catch (e) { return NextResponse.json({ error: "Error" }, { status: 500 }); } }