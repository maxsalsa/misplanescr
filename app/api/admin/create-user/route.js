import { prisma } from "@/lib/db"; import { hash } from "bcryptjs"; import { NextResponse } from "next/server"; export async function POST(req) { const { name, email, tempPass, subject, months } = await req.json(); const pass = await hash(tempPass, 10); const user = await prisma.user.create({ data: { name, email, password: pass, role: "USER", mustChangePassword: true } }); const exp = new Date(); exp.setMonth(exp.getMonth() + parseInt(months)); await prisma.license.create({ data: { userId: user.id, subject, expiresAt: exp, isActive: true } }); return NextResponse.json({ success: true }); }