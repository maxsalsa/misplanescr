import { GoogleGenerativeAI } from "@google/generative-ai"; import { NextResponse } from "next/server"; export async function POST(req) { const { topics, totalPoints } = await req.json(); const SYSTEM_PROMPT = `ERES EXPERTO EN EVALUACIÃ“N. Genera prueba acumulativa de ${totalPoints} pts. OUTPUT JSON: { "items": { "selection": [], "short_answer": [], "development": [] }, "answer_key": {} }`; const userPrompt = `TEMAS: ${topics.map(t=>t.title).join(", ")}.`; let exam = null; if (process.env.GEMINI_API_KEY) { const gen = new GoogleGenerativeAI(process.env.GEMINI_API_KEY).getGenerativeModel({ model: "gemini-pro" }); const res = await gen.generateContent(`${SYSTEM_PROMPT}\n${userPrompt}`); exam = JSON.parse(res.response.text().replace(/```json|```/g,"").trim()); } return NextResponse.json({ success: true, exam }); }